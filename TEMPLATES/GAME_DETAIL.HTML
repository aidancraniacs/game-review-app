{% extends "BASE.HTML" %}
{% block content %}

<section class="game-detail">

  <a
    href="{{ url_for('games') }}"
    class="btn ghost small back-btn"
    data-pjax
  >
    ← Back to catalogue
  </a>


  <div class="game-detail-header">
    <div class="game-cover">
      <img
        src="{{ url_for('static', filename=game.cover_url) if game.cover_url else url_for('static', filename='cover-placeholder.png') }}"
        alt="{{ game.title }} cover"
      >
    </div>

    <div class="game-meta">
      <h1>{{ game.title }}</h1>

      <p class="rating big">
        {% if avg_rating %}
          ★ {{ avg_rating }}/5
          <span class="muted">· {{ review_count }} reviews</span>
        {% else %}
          <span class="muted">No ratings yet</span>
        {% endif %}
      </p>

      {% if game.description %}
        <p class="description">{{ game.description }}</p>
      {% endif %}
    </div>
  </div>

  <section class="reviews-section">
    <h2>Player reviews</h2>

    {% if reviews %}
      <div class="review-list">
        {% for review in reviews %}
          <article class="review-card">
            <header class="review-header">
              <strong>{{ review.user.username }}</strong>
              <span class="stars">★ {{ review.rating }}/5</span>
            </header>

            {% if review.content %}
              <p class="review-content">{{ review.content }}</p>
            {% endif %}

            <p class="muted small">
              {{ review.created_at.strftime("%b %d, %Y") }}
            </p>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <p class="muted">No reviews yet. Be the first to review this game.</p>
    {% endif %}
  </section>

</section>

{% endblock %}